# ğŸ¢ HVAC-DDPG-Control

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-3776AB?style=for-the-badge&logo=python&logoColor=white)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)
![Status](https://img.shields.io/badge/Status-Active-success?style=for-the-badge)

**ğŸ¤– Deep Deterministic Policy Gradient (DDPG) for Intelligent HVAC Control**

*Tá»‘i Æ°u hÃ³a há»‡ thá»‘ng Ä‘iá»u hÃ²a khÃ´ng khÃ­ báº±ng Deep Reinforcement Learning*

</div>

---

## ğŸ“‹ Má»¥c Lá»¥c

- [ğŸ¯ Giá»›i Thiá»‡u](#-giá»›i-thiá»‡u)
- [ğŸ­ MÃ´ HÃ¬nh MÃ´ Phá»ng Modelica](#-mÃ´-hÃ¬nh-mÃ´-phá»ng-modelica-hvacmo)
- [ğŸ¤– Chi Tiáº¿t Thuáº­t ToÃ¡n DDPG](#-chi-tiáº¿t-thuáº­t-toÃ¡n-ddpg-deep-deterministic-policy-gradient)
- [âš¡ Chi Tiáº¿t CÃ´ng Suáº¥t Thiáº¿t Bá»‹ HVAC](#-chi-tiáº¿t-cÃ´ng-suáº¥t-thiáº¿t-bá»‹-hvac)
- [âœ¨ TÃ­nh NÄƒng Ná»•i Báº­t](#-tÃ­nh-nÄƒng-ná»•i-báº­t)
- [ğŸ“ Cáº¥u TrÃºc Project](#-cáº¥u-trÃºc-project)
- [ğŸ”§ CÃ i Äáº·t](#-cÃ i-Ä‘áº·t)
- [ğŸš€ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng](#-hÆ°á»›ng-dáº«n-sá»­-dá»¥ng)
- [ğŸ“Š Káº¿t Quáº£](#-káº¿t-quáº£)

---

## ğŸ¯ Giá»›i Thiá»‡u

**HVAC-DDPG-Control** lÃ  má»™t há»‡ thá»‘ng Ä‘iá»u khiá»ƒn thÃ´ng minh cho há»‡ thá»‘ng HVAC (Heating, Ventilation, and Air Conditioning) sá»­ dá»¥ng thuáº­t toÃ¡n **Deep Deterministic Policy Gradient (DDPG)**. 

Há»‡ thá»‘ng sá»­ dá»¥ng **Functional Mock-up Unit (FMU)** Ä‘á»ƒ mÃ´ phá»ng Ä‘á»™ng lá»±c há»c cá»§a há»‡ thá»‘ng HVAC thá»±c táº¿, káº¿t há»£p vá»›i dá»¯ liá»‡u thá»i tiáº¿t thá»±c tá»« cÃ¡c Ä‘á»‹a Ä‘iá»ƒm táº¡i Viá»‡t Nam (HÃ  Ná»™i, ÄÃ  Náºµng, TP.HCM).

### ğŸ¯ Má»¥c tiÃªu chÃ­nh:
- ğŸŒ¡ï¸ **Duy trÃ¬ nhiá»‡t Ä‘á»™ thoáº£i mÃ¡i** trong pháº¡m vi 26-27.5Â°C
- ğŸ’§ **Kiá»ƒm soÃ¡t Ä‘á»™ áº©m** trong khoáº£ng 45-65%
- âš¡ **Tá»‘i Æ°u hÃ³a nÄƒng lÆ°á»£ng tiÃªu thá»¥**
- ğŸ”® **Há»— trá»£ dá»± bÃ¡o thá»i tiáº¿t** Ä‘á»ƒ Ä‘iá»u khiá»ƒn chá»§ Ä‘á»™ng

---

## ğŸ­ MÃ´ HÃ¬nh MÃ´ Phá»ng Modelica (HVAC.mo)

> *TrÃ¡i tim váº­t lÃ½ cá»§a há»‡ thá»‘ng - MÃ´ phá»ng Ä‘á»™ng lá»±c há»c AHU hoÃ n chá»‰nh*

### ğŸ“ Tá»•ng Quan Kiáº¿n TrÃºc

MÃ´ hÃ¬nh Modelica (`HVAC.mo`) lÃ  má»™t mÃ´ phá»ng **Air Handling Unit (AHU)** hoÃ n chá»‰nh Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn ná»n táº£ng thÆ° viá»‡n **Modelica Buildings Library v12.1.0**. MÃ´ hÃ¬nh Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘áº·c biá»‡t Ä‘á»ƒ tÃ­ch há»£p vá»›i **Reinforcement Learning** thÃ´ng qua chuáº©n **FMI (Functional Mock-up Interface)**.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ¢ HVAC_FMU Package                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ“¦ Medium Definitions                                                  â”‚   â”‚
â”‚  â”‚  â€¢ MediumA = Buildings.Media.Air (with CO2 tracking)                    â”‚   â”‚
â”‚  â”‚  â€¢ MediumW = Buildings.Media.Water                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â„ï¸ Carnot_TEva_NoWarn (Custom Chiller Model)                          â”‚   â”‚
â”‚  â”‚  â€¢ Energy-balanced chiller with manual control                          â”‚   â”‚
â”‚  â”‚  â€¢ TEva setpoint modulated by control signal                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸŒ¬ï¸ AHU_FMU_Core_WeatherInput (Main AHU Model)                         â”‚   â”‚
â”‚  â”‚  â€¢ Complete AHU with all HVAC components                                â”‚   â”‚
â”‚  â”‚  â€¢ Weather data inputs from Python                                       â”‚   â”‚
â”‚  â”‚  â€¢ RL control inputs/outputs interface                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”§ ThÃ´ng Sá»‘ Há»‡ Thá»‘ng (System Parameters)

| Parameter | GiÃ¡ trá»‹ | ÄÆ¡n vá»‹ | MÃ´ táº£ |
|-----------|---------|--------|-------|
| `mAir_flow_nominal` | 0.24 | kg/s | LÆ°u lÆ°á»£ng khÃ´ng khÃ­ Ä‘á»‹nh má»©c |
| `mWat_flow_nominal` | 0.35 | kg/s | LÆ°u lÆ°á»£ng nÆ°á»›c láº¡nh Ä‘á»‹nh má»©c |
| `Vzone` | 168 | mÂ³ | Thá»ƒ tÃ­ch vÃ¹ng Ä‘iá»u hÃ²a |
| `COP_chiller_nominal` | 1.5 | - | Há»‡ sá»‘ hiá»‡u suáº¥t chiller |
| `QEva_flow_nominal` | -6000 | W | CÃ´ng suáº¥t lÃ m láº¡nh Ä‘á»‹nh má»©c |
| `Q_heater_nominal` | 2000 | W | CÃ´ng suáº¥t sÆ°á»Ÿi Ä‘á»‹nh má»©c |
| `UA_nominal` | 1500 | W/K | Há»‡ sá»‘ truyá»n nhiá»‡t coil |
| `Pfan_nominal` | 70 | W | CÃ´ng suáº¥t quáº¡t cáº¥p khÃ­ |
| `PfanEA_nominal` | 50 | W | CÃ´ng suáº¥t quáº¡t tháº£i |
| `PpumpCW_nominal` | 180 | W | CÃ´ng suáº¥t bÆ¡m nÆ°á»›c láº¡nh |
| `nOccMax` | 10 | ngÆ°á»i | Sá»‘ ngÆ°á»i tá»‘i Ä‘a trong phÃ²ng |
| `CO2_outdoor_ppm` | 400 | ppm | Ná»“ng Ä‘á»™ CO2 ngoÃ i trá»i |

---

### ğŸŒ¬ï¸ SÆ¡ Äá»“ Luá»“ng KhÃ´ng KhÃ­ (Airflow Diagram)

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚                     ğŸ  CONDITIONED ZONE                       â”‚
                                    â”‚                      (V = 168 mÂ³)                             â”‚
                                    â”‚                                                               â”‚
                                    â”‚   T_zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º T_zone [K]         â”‚
                                    â”‚   RH_zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º RH_zone [0-1]      â”‚
                                    â”‚   CO2_zone â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º CO2_zone [ppm]     â”‚
                                    â”‚                                                               â”‚
                                    â”‚   ğŸ‘¥ Internal Gains: CO2 + Moisture + Heat                   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                       â”‚                â”‚
                                                       â”‚ Supply Air     â”‚ Return Air
                                                       â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         ğŸŒ¬ï¸ AIR HANDLING UNIT (AHU)                                        â”‚
â”‚                                                                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  ğŸŒ¤ï¸ Outdoor â”‚    â”‚  ğŸšª Damper  â”‚    â”‚  ğŸ§¹ Filter  â”‚    â”‚   â›“ï¸ Mix   â”‚    â”‚  â„ï¸ Cooling â”‚              â”‚
â”‚  â”‚    Air      â”‚â”€â”€â”€â–ºâ”‚    OA       â”‚â”€â”€â”€â–ºâ”‚   preFil    â”‚â”€â”€â”€â–ºâ”‚   Junction  â”‚â”€â”€â”€â–ºâ”‚    Coil     â”‚              â”‚
â”‚  â”‚  (ambAir)   â”‚    â”‚  (damOA)    â”‚    â”‚             â”‚    â”‚   (mixT)    â”‚    â”‚  (cooCoil)  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                                                         â”‚                  â”‚                      â”‚
â”‚        â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â–¼                      â”‚
â”‚        â”‚                              â”‚ Return Air                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚                              â”‚                                      â”‚  ğŸ’§ Dehum   â”‚              â”‚
â”‚        â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                              â”‚   Filter    â”‚              â”‚
â”‚        â”‚                      â”‚  ğŸšª Damper RA â”‚                              â”‚ (dehumFilter)â”‚              â”‚
â”‚        â”‚                      â”‚   (damRA)     â”‚                              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚                      â”‚
â”‚        â”‚                              â”‚                                             â–¼                      â”‚
â”‚        â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚                      â”‚   â›“ï¸ Return  â”‚                              â”‚  ğŸ”¥ Heater  â”‚              â”‚
â”‚        â”‚                      â”‚   Junction    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   Coil      â”‚              â”‚
â”‚        â”‚                      â”‚    (retJ)     â”‚                   â”‚          â”‚  (heaCoil)  â”‚              â”‚
â”‚        â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                              â”‚                           â”‚                  â”‚                      â”‚
â”‚        â”‚                              â–¼                           â”‚                  â–¼                      â”‚
â”‚        â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚                      â”‚  ğŸšª Damper  â”‚              â”‚ ğŸ“Š Sensors  â”‚    â”‚  ğŸ“¡ T & RH  â”‚              â”‚
â”‚        â”‚                      â”‚    EA       â”‚              â”‚  T, RH, CO2 â”‚    â”‚   Sensors   â”‚              â”‚
â”‚        â”‚                      â”‚  (damEA)    â”‚              â”‚             â”‚    â”‚ (Tsa, RHsa) â”‚              â”‚
â”‚        â”‚                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚        â”‚                             â”‚                                               â”‚                      â”‚
â”‚        â”‚                             â–¼                                               â–¼                      â”‚
â”‚        â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚        â”‚                      â”‚ ğŸŒ€ Exhaust  â”‚                                 â”‚ ğŸŒ€ Supply   â”‚              â”‚
â”‚        â”‚                      â”‚    Fan      â”‚                                 â”‚    Fan      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (fanEA)   â”‚                                 â”‚   (fanSA)   â”‚   To Zone    â”‚
â”‚          Exhaust to Outside   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### â„ï¸ Há»‡ Thá»‘ng NÆ°á»›c Láº¡nh (Chilled Water System)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ’§ CHILLED WATER LOOP                                â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ ğŸ­ Condenserâ”‚      â”‚  â„ï¸ Chiller â”‚      â”‚ ğŸ“¤ Evaporatorâ”‚                â”‚
â”‚   â”‚   Supply    â”‚â”€â”€â”€â”€â”€â–ºâ”‚  (Carnot)   â”‚â”€â”€â”€â”€â”€â–ºâ”‚   Outlet     â”‚                â”‚
â”‚   â”‚ (conSupply) â”‚      â”‚  COP = 1.5  â”‚      â”‚              â”‚                â”‚
â”‚   â”‚  T = 25Â°C   â”‚      â”‚ Q = -6 kW   â”‚      â”‚  T_cold      â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                               â”‚                    â”‚                        â”‚
â”‚                               â”‚ Condenser          â”‚ Evaporator             â”‚
â”‚                               â”‚ Return             â”‚ Supply                 â”‚
â”‚                               â–¼                    â–¼                        â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                        â”‚ ğŸ“¥ Condenserâ”‚      â”‚  ğŸ”„ Pump    â”‚                â”‚
â”‚                        â”‚   Return    â”‚      â”‚   (pumpCW)  â”‚                â”‚
â”‚                        â”‚ (conReturn) â”‚      â”‚  dp = 8 kPa â”‚                â”‚
â”‚                        â”‚  T = 30Â°C   â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚                        â”‚
â”‚                                                    â–¼                        â”‚
â”‚                                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                                             â”‚  ğŸš¿ Valve   â”‚                â”‚
â”‚                                             â”‚   (valCW)   â”‚                â”‚
â”‚                                             â”‚  PI Control â”‚                â”‚
â”‚                                             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                    â”‚                        â”‚
â”‚                                                    â–¼                        â”‚
â”‚                                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                                             â”‚ â„ï¸ Cooling  â”‚                â”‚
â”‚                                             â”‚    Coil     â”‚â—„â”€â”€â”€â”€â”€ Air Flow â”‚
â”‚                                             â”‚ (cooCoil)   â”‚                 â”‚
â”‚                                             â”‚ UA = 1500   â”‚                 â”‚
â”‚                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                    â”‚                        â”‚
â”‚                                                    â””â”€â”€â”€â”€â”€â”€â”€â–º Back to Chillerâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ® Giao Diá»‡n RL (Reinforcement Learning Interface)

#### ğŸ“¥ Control Inputs (RL Actions)

| Input | KÃ½ hiá»‡u | Pháº¡m vi | MÃ´ táº£ | Safety Limits |
|-------|---------|---------|-------|---------------|
| **Fan Speed** | `uFan` | [0, 1] | Tá»‘c Ä‘á»™ quáº¡t cáº¥p khÃ­ | min = 0.3 |
| **Outside Air Damper** | `uOA` | [0, 1] | Äá»™ má»Ÿ damper giÃ³ tÆ°Æ¡i | min = 0.4 (trÃ¡nh flow reversal) |
| **Chiller Capacity** | `uChiller` | [0, 1] | CÃ´ng suáº¥t chiller | clamp [0, 1] |
| **Heater Capacity** | `uHeater` | [0, 1] | CÃ´ng suáº¥t sÆ°á»Ÿi | max = 0.7 + 0.3Ã—uOA |
| **Exhaust Fan Speed** | `uFanEA` | [0, 1] | Tá»‘c Ä‘á»™ quáº¡t tháº£i | min = 0.2 |
| **Occupancy** | `occupancy` | [0, 1] | Tá»· lá»‡ ngÆ°á»i trong phÃ²ng | - |

#### ğŸ“¤ Observations (RL States)

| Output | KÃ½ hiá»‡u | ÄÆ¡n vá»‹ | MÃ´ táº£ |
|--------|---------|--------|-------|
| **Supply Air Temperature** | `T_SA` | K | Nhiá»‡t Ä‘á»™ khÃ´ng khÃ­ cáº¥p |
| **Supply Air Humidity** | `RH_SA` | [0-1] | Äá»™ áº©m tÆ°Æ¡ng Ä‘á»‘i khÃ­ cáº¥p |
| **Supply Air Flow** | `Vdot_SA` | mÂ³/s | LÆ°u lÆ°á»£ng thá»ƒ tÃ­ch khÃ­ cáº¥p |
| **Zone Temperature** | `T_zone` | K | Nhiá»‡t Ä‘á»™ vÃ¹ng Ä‘iá»u hÃ²a |
| **Zone Humidity** | `RH_zone` | [0-1] | Äá»™ áº©m tÆ°Æ¡ng Ä‘á»‘i vÃ¹ng |
| **Zone CO2** | `CO2_zone_ppm` | ppm | Ná»“ng Ä‘á»™ CO2 trong phÃ²ng |
| **SA After Cooling** | `T_SA_afterCooling` | K | Nhiá»‡t Ä‘á»™ sau coil láº¡nh |

#### âš¡ Energy Outputs

| Output | KÃ½ hiá»‡u | ÄÆ¡n vá»‹ | CÃ´ng thá»©c |
|--------|---------|--------|-----------|
| **Supply Fan Power** | `P_fan` | W | $P_{fan} = P_{nominal} \times (á¹/á¹_{nominal})^3$ |
| **Exhaust Fan Power** | `P_fanEA` | W | $P_{fanEA} = P_{nominal} \times (á¹/á¹_{nominal})^3$ |
| **Chiller Power** | `P_chiller` | W | $P_{chiller} = |Q_{eva}| / COP$ |
| **Pump Power** | `P_pump` | W | $P_{pump} = P_{nominal} \times (á¹/á¹_{nominal})^3$ |
| **Heater Power** | `P_heater` | W | $P_{heater} = Q_{heater}$ |
| **Total Power** | `P_total` | W | $\sum$ (Fan + FanEA + Chiller + Pump + Heater) |

---

### ğŸŒ¤ï¸ Weather Data Interface

```python
# Weather inputs from Python (interpolated from CSV at each timestep)
weather_inputs = {
    'TDryBul':  float,  # Outdoor dry bulb temperature [K]
    'relHum':   float,  # Outdoor relative humidity [0-1]  
    'pAtm':     float,  # Atmospheric pressure [Pa]
    'winSpe':   float,  # Wind speed [m/s]
    'HDirNor':  float,  # Direct normal solar irradiation [W/mÂ²]
    'HDifHor':  float,  # Diffuse horizontal solar irradiation [W/mÂ²]
}
```

---

### ğŸ”„ Control Logic & Safety Features

#### 1ï¸âƒ£ First-Order Filters (Smooth Transitions)

```
Signal Flow:  Raw Input â”€â”€â–º FirstOrder Filter (Ï„=180s) â”€â”€â–º Limiter â”€â”€â–º Actuator
```

| Filter | Time Constant (Ï„) | Purpose |
|--------|-------------------|---------|
| `filtOA` | 180s | Smooth OA damper transitions |
| `filtRA` | 180s | Smooth RA damper transitions |
| `filtEA` | 180s | Smooth EA damper transitions |
| `filtValve` | 200s | Smooth chilled water valve |
| `filtHeater` | 180s | Smooth heater modulation |

#### 2ï¸âƒ£ PI Controller for Chilled Water Valve

```python
# Setpoint: T_SA_afterCooling = 285.15 K (12Â°C)
# Controller: PI vá»›i k=0.3, Ti=300s
valve_position = PI_controller(
    setpoint = 285.15,  # K
    measured = T_SA_afterCooling,
    k = 0.3,
    Ti = 300  # s
)
```

#### 3ï¸âƒ£ Damper Flow Balance

```python
# Äáº£m báº£o cÃ¢n báº±ng lÆ°u lÆ°á»£ng Ä‘á»ƒ trÃ¡nh Ã¡p suáº¥t Ã¢m
yRA = 1 - yOA  # Return Air = 1 - Outside Air
yEA = yOA      # Exhaust Air = Outside Air (balanced)
```

#### 4ï¸âƒ£ Dehumidification Control

```python
# Dynamic dehumidification linked to chiller
uDehum = min(2.0, max(0.0, 2 * uChiller))
# Khi chiller hoáº¡t Ä‘á»™ng máº¡nh, dehumidification tÄƒng theo
```

---

### ğŸ“Š Component Details

#### ğŸ§Š Cooling Coil (WetCoilCounterFlow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               WET COIL COUNTER FLOW                  â”‚
â”‚                                                      â”‚
â”‚  Air Side (Medium1):     Water Side (Medium2):       â”‚
â”‚  á¹_air = 0.24 kg/s      á¹_water = 0.35 kg/s        â”‚
â”‚  dp = 100 Pa            dp = 2000 Pa                â”‚
â”‚  Ï„â‚ = 5s                Ï„â‚‚ = 20s                    â”‚
â”‚                                                      â”‚
â”‚  Heat Transfer:                                      â”‚
â”‚  UA = 1500 W/K                                       â”‚
â”‚  r_nominal = 2/3                                     â”‚
â”‚  nEle = 6 (discretization elements)                 â”‚
â”‚                                                      â”‚
â”‚  Dynamics: FixedInitial                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### â„ï¸ Chiller (Carnot_TEva_NoWarn)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               CARNOT CHILLER MODEL                   â”‚
â”‚                                                      â”‚
â”‚  Operating Mode:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ T_eva = uÃ—T_cold + (1-u)Ã—T_off              â”‚    â”‚
â”‚  â”‚                                              â”‚    â”‚
â”‚  â”‚ u = 0: T_eva = 298.15 K (OFF - warm)        â”‚    â”‚
â”‚  â”‚ u = 1: T_eva = 277.15 K (FULL - cold)       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                      â”‚
â”‚  Energy Balance:                                     â”‚
â”‚  Q_con = |Q_eva| + P_electric                        â”‚
â”‚  P_electric = |Q_eva| / COP                         â”‚
â”‚  COP_nominal = 1.5                                  â”‚
â”‚                                                      â”‚
â”‚  Capacity: Q_eva = -6000 W (cooling)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸŒ€ Fans (FlowControlled_m_flow)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FAN MODELS                         â”‚
â”‚                                                      â”‚
â”‚  Supply Fan (fanSA):          Exhaust Fan (fanEA):  â”‚
â”‚  á¹_nominal = 0.24 kg/s       á¹_nominal = 0.24 kg/s â”‚
â”‚  P_nominal = 70 W             P_nominal = 50 W      â”‚
â”‚  dpMax = 5Ã—10Â¹â° Pa           dpMax = 10Â¹â° Pa       â”‚
â”‚                                                      â”‚
â”‚  Pressure Curve:                                     â”‚
â”‚  V_flow = [0, á¹/1.2, 2Ã—á¹/1.2]                      â”‚
â”‚  dp = [600, 400, 0] Pa (SA)                         â”‚
â”‚  dp = [400, 300, 0] Pa (EA)                         â”‚
â”‚                                                      â”‚
â”‚  Power Law: P = P_nominal Ã— (á¹/á¹_nominal)Â³         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ›¡ï¸ Stability Features for RL Training

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STABILITY FEATURES                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  âœ… allowFlowReversal = true   â†’ Cho phÃ©p dÃ²ng cháº£y ngÆ°á»£c           â”‚
â”‚  âœ… dpMax = 10â¹ - 5Ã—10Â¹â° Pa   â†’ TrÃ¡nh assertion failures           â”‚
â”‚  âœ… linearized = true          â†’ Linearize damper characteristics   â”‚
â”‚  âœ… from_dp = true/false       â†’ PhÃ¹ há»£p cho tá»«ng component         â”‚
â”‚  âœ… FirstOrder filters         â†’ Smooth control signal transitions  â”‚
â”‚  âœ… Safety limits on inputs    â†’ Prevent physically impossible statesâ”‚
â”‚                                                                      â”‚
â”‚  System Settings:                                                    â”‚
â”‚  â€¢ energyDynamics = SteadyStateInitial                              â”‚
â”‚  â€¢ massDynamics = SteadyStateInitial                                â”‚
â”‚  â€¢ m_flow_small = 1e-4 kg/s                                         â”‚
â”‚  â€¢ dp_small = 100 Pa                                                â”‚
â”‚  â€¢ T_ambient = 301.15 K                                             â”‚
â”‚  â€¢ p_ambient = 101325 Pa                                            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”— Simulation Settings

```python
experiment_settings = {
    'StartTime': 0,           # seconds
    'StopTime': 31536000,     # 1 year (365 days)
    'Interval': 900,          # 15 minutes timestep
    'Tolerance': 1e-5         # Solver tolerance
}
```

---

### ğŸ“ Files

| File | MÃ´ táº£ |
|------|-------|
| **`HVAC.mo`** | Modelica source code - Human readable, editable |
| **`HVAC.fmu`** | Compiled FMU - Binary executable for co-simulation |

---

## ğŸ¤– Chi Tiáº¿t Thuáº­t ToÃ¡n DDPG (Deep Deterministic Policy Gradient)

> *Bá»™ nÃ£o thÃ´ng minh Ä‘iá»u khiá»ƒn há»‡ thá»‘ng HVAC*

### ğŸ“ Kiáº¿n TrÃºc Tá»•ng Quan

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ§  DDPG AGENT ARCHITECTURE                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                              ğŸ­ ACTOR NETWORK                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚   â”‚
â”‚  â”‚  â”‚ State   â”‚â”€â”€â–ºâ”‚  FC1    â”‚â”€â”€â–ºâ”‚  FC2    â”‚â”€â”€â–ºâ”‚  FC3    â”‚â”€â”€â–ºâ”‚  FC4    â”‚â”€â”€â–º Action â”‚   â”‚
â”‚  â”‚  â”‚ (14/15) â”‚   â”‚  512    â”‚   â”‚  512    â”‚   â”‚  256    â”‚   â”‚   5     â”‚   [0, 1]  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ +LayerN â”‚   â”‚ +LayerN â”‚   â”‚ +LayerN â”‚   â”‚ Sigmoid â”‚           â”‚   â”‚
â”‚  â”‚                â”‚ +ReLU   â”‚   â”‚ +ReLU   â”‚   â”‚ +ReLU   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚   â”‚
â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         âš–ï¸ TWIN Q-NETWORK CRITIC                                 â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚  â”‚  â”‚  Q1: State+Action â”€â”€â–º 512 â”€â”€â–º 512 â”€â”€â–º 256 â”€â”€â–º Q-value                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚  â”‚                              â†“                                                   â”‚   â”‚
â”‚  â”‚                         min(Q1, Q2) â†’ Reduces overestimation                    â”‚   â”‚
â”‚  â”‚                              â†‘                                                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚   â”‚
â”‚  â”‚  â”‚  Q2: State+Action â”€â”€â–º 512 â”€â”€â–º 512 â”€â”€â–º 256 â”€â”€â–º Q-value                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ğŸ“¦ PRIORITIZED REPLAY BUFFER                              â”‚   â”‚
â”‚  â”‚    Capacity: 200,000 transitions                                                â”‚   â”‚
â”‚  â”‚    Sampling: Priority âˆ |TD-error|^Î± (Î± = 0.6)                                  â”‚   â”‚
â”‚  â”‚    Importance Sampling: weights = (N Ã— P(i))^(-Î²) (Î² = 0.4)                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        ğŸ² ADAPTIVE OU NOISE                                      â”‚   â”‚
â”‚  â”‚    dX = Î¸(Î¼ - X)dt + ÏƒdW                                                        â”‚   â”‚
â”‚  â”‚    Ïƒ(t) = Ïƒ_start Ã— exp(-2.5 Ã— t/decay_steps) + Ïƒ_end                           â”‚   â”‚
â”‚  â”‚    Ïƒ: 0.7 â†’ 0.15 over 200,000 steps                                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”¢ Chi Tiáº¿t Hyperparameters

#### ğŸ¯ Network Architecture

| Component | Parameter | Value | MÃ´ táº£ |
|-----------|-----------|-------|-------|
| **Actor** | Input dim | 14 (no FC) / 15 (with FC) | State dimension |
| | Hidden layers | [512, 512, 256] | Fully connected layers |
| | Output dim | 5 | Action dimension |
| | Activation | ReLU + LayerNorm | Hidden layers |
| | Output activation | Sigmoid | Maps to [0, 1] |
| | Weight init | Xavier Uniform | Better gradient flow |
| | Output layer init | Uniform [-3e-3, 3e-3] | Small initial weights |
| **Critic** | Input dim | State + Action = 19/20 | Concatenated input |
| | Hidden layers | [512, 512, 256] Ã— 2 | Twin Q-networks |
| | Output dim | 1 Ã— 2 | Two Q-values |

#### ğŸ“Š Training Parameters

| Parameter | Symbol | Value | Ã nghÄ©a |
|-----------|--------|-------|---------|
| **Actor Learning Rate** | `lr_actor` | 1Ã—10â»â´ | Tá»‘c Ä‘á»™ há»c Actor - nhá» hÆ¡n Critic Ä‘á»ƒ á»•n Ä‘á»‹nh |
| **Critic Learning Rate** | `lr_critic` | 3Ã—10â»â´ | Tá»‘c Ä‘á»™ há»c Critic - cao hÆ¡n Ä‘á»ƒ há»c Q-value nhanh |
| **Discount Factor** | `Î³` (gamma) | 0.99 | Trá»ng sá»‘ reward tÆ°Æ¡ng lai - gáº§n 1 Ä‘á»ƒ nhÃ¬n xa |
| **Soft Update Rate** | `Ï„` (tau) | 0.005 | Target network update rate - nhá» Ä‘á»ƒ á»•n Ä‘á»‹nh |
| **Batch Size** | - | 512 | Sá»‘ samples má»—i láº§n train |
| **Gradient Clipping** | - | 1.0 | NgÄƒn exploding gradients |

#### ğŸ² Exploration Parameters

| Parameter | Symbol | Value | MÃ´ táº£ |
|-----------|--------|-------|-------|
| **OU Theta** | `Î¸` | 0.15 | Mean reversion speed - tá»‘c Ä‘á»™ quay vá» mean |
| **OU Sigma Start** | `Ïƒ_start` | 0.7 | Initial noise magnitude - khÃ¡m phÃ¡ máº¡nh ban Ä‘áº§u |
| **OU Sigma End** | `Ïƒ_end` | 0.15 | Final noise magnitude - giáº£m dáº§n theo thá»i gian |
| **Decay Steps** | - | 200,000 | Steps Ä‘á»ƒ decay Ïƒ tá»« 0.7 xuá»‘ng 0.15 |
| **Epsilon Start** | `Îµ_start` | 1.0 | Initial random action probability |
| **Epsilon End** | `Îµ_end` | 0.2 | Final random action probability |
| **Epsilon Decay** | - | 0.9997 | Per-step decay rate |

#### ğŸ“ˆ Adaptive Learning Rate Scheduler

| Parameter | Value | MÃ´ táº£ |
|-----------|-------|-------|
| **Patience** | 3 episodes | Episodes khÃ´ng cáº£i thiá»‡n trÆ°á»›c khi giáº£m LR |
| **Factor** | 0.5 | LR má»›i = LR cÅ© Ã— 0.5 |
| **Min LR** | 1Ã—10â»â· | Learning rate tá»‘i thiá»ƒu |

---

### ğŸ Cáº¥u TrÃºc State Vector (14/15 dimensions)

```python
state = [
    # === FMU Outputs (8 dims) ===
    T_zone,           # [0] Zone temperature [K]
    RH_zone,          # [1] Zone relative humidity [0-1]
    CO2_zone_ppm,     # [2] Zone CO2 concentration [ppm]
    T_SA,             # [3] Supply air temperature [K]
    T_SA_afterCooling,# [4] SA temp after cooling coil [K]
    RH_SA,            # [5] Supply air humidity [0-1]
    Vdot_SA,          # [6] Supply air volume flow [mÂ³/s]
    P_total,          # [7] Total power consumption [W]
    
    # === Weather (2 dims) ===
    T_outdoor,        # [8] Outdoor temperature [K]
    RH_outdoor,       # [9] Outdoor humidity [0-1]
    
    # === Time Features (2 dims) ===
    hour_of_day / 24, # [10] Normalized hour [0-1]
    day_of_week / 7,  # [11] Normalized day [0-1]
    
    # === Occupancy (1 dim) ===
    occupancy,        # [12] Occupancy fraction [0-1]
    
    # === Previous Action (1 dim) ===
    prev_action_avg,  # [13] Mean of previous action [0-1]
    
    # === Weather Forecast (optional, 1 dim) ===
    T_forecast_1h,    # [14] Temperature forecast +1h [K] (only with forecast)
]
```

---

### ğŸ¯ Cáº¥u TrÃºc Action Vector (5 dimensions)

```python
action = [
    uFan,     # [0] Supply fan speed          [0.1 - 0.8]  â†’ mapped from [0-1]
    uOA,      # [1] Outside air damper        [0.3 - 0.9]  â†’ mapped from [0-1]
    uChiller, # [2] Chiller capacity          [0.0 - 1.0]  â†’ direct
    uHeater,  # [3] Heater capacity           [0.0 - 1.0]  â†’ direct
    uFanEA,   # [4] Exhaust fan speed         [0.2 - 0.7]  â†’ mapped from [0-1]
]

# Action Mapping in Environment:
uFan_actual   = 0.1 + action[0] * (0.8 - 0.1)   # [0.1, 0.8]
uOA_actual    = 0.3 + action[1] * (0.9 - 0.3)   # [0.3, 0.9]
uChiller_actual = action[2]                      # [0.0, 1.0]
uHeater_actual  = action[3]                      # [0.0, 1.0]
uFanEA_actual   = 0.2 + action[4] * (0.7 - 0.2) # [0.2, 0.7]
```

---

### ğŸ† Hierarchical Reward Function

> *Reward Ä‘Æ°á»£c thiáº¿t káº¿ theo cáº¥u trÃºc phÃ¢n cáº¥p: Temperature > Humidity > Energy*

#### ğŸ“ CÃ´ng Thá»©c Reward

$$R_{total} = R_{base} - C_{total} + B_{comfort} + B_{stability} + B_{action}$$

Trong Ä‘Ã³:
- $R_{base} = 2.0$ (baseline reward)
- $C_{total}$ = Tá»•ng chi phÃ­ (costs)
- $B_{comfort}$ = Bonus khi trong comfort zone
- $B_{stability}$ = Bonus khi á»•n Ä‘á»‹nh
- $B_{action}$ = Bonus cho action diversity

#### ğŸ“Š Chi Tiáº¿t Cost Components

| Component | Weight (Occupied) | Weight (Unoccupied) | Formula |
|-----------|-------------------|---------------------|---------|
| **Temperature** | $w_T = 5.0$ | $w_T = 1.5$ | $C_T = w_T \times d_T$ |
| **Humidity** | $w_{RH} = 2.5$ | $w_{RH} = 0.5$ | $C_{RH} = w_{RH} \times d_{RH}$ |
| **Energy** | $w_E = 4.0$ | $w_E = 6.0$ | $C_E = w_E \times (P/P_{ref})^2$ |
| **Smoothness** | 0.15 | 0.15 | $C_s = 0.15 \times \sum(a_t - a_{t-1})^2$ |

#### ğŸŒ¡ï¸ Comfort Zones & Curriculum Learning

| Phase | Episode | T Range (Â°C) | RH Range |
|-------|---------|--------------|----------|
| **Initial** | 0 | 24.0 - 29.0 | 0.35 - 0.75 |
| **Mid** | 15 | 25.0 - 28.25 | 0.40 - 0.70 |
| **Final** | 30+ | 26.0 - 27.5 | 0.45 - 0.65 |

```python
# Curriculum progression formula
progress = min(1.0, episode / 30)
T_low  = 24.0 + progress * (26.0 - 24.0)   # 24 â†’ 26
T_high = 29.0 + progress * (27.5 - 29.0)   # 29 â†’ 27.5
RH_low = 0.35 + progress * (0.45 - 0.35)   # 0.35 â†’ 0.45
RH_high = 0.75 + progress * (0.65 - 0.75)  # 0.75 â†’ 0.65
```

#### ğŸ Bonus & Penalties

| Bonus/Penalty | Value | Condition |
|---------------|-------|-----------|
| **Comfort Bonus** | +2.0 | T vÃ  RH trong comfort zone + occupied |
| **Stability Bonus** | +0.5 | >10 steps liÃªn tá»¥c trong comfort |
| **Temperature Stability** | +0.3 | Î”T < 0.5Â°C vÃ  T trong comfort |
| **Action Change Bonus** | +0.3 | 0.05 < mean_change < 0.3 |
| **Severe Penalty** | -5.0 | T hoáº·c RH vÆ°á»£t severe limits |
| **Combo Penalty** | -2.0 | T tháº¥p + RH cao Ä‘á»“ng thá»i |
| **Action Extreme Penalty** | -0.2 | Action < 0.05 hoáº·c > 0.95 |

#### ğŸ“ Reward Bounds

$$R_{final} = \text{clip}(R_{total}, -10.0, +5.0)$$

---

### ğŸ”„ Training Loop Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ”„ DDPG TRAINING FLOW                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  1ï¸âƒ£ INITIALIZE                        â”‚
                    â”‚  â€¢ Actor & Actor_target (Î¸ = Î¸')      â”‚
                    â”‚  â€¢ Critic & Critic_target (Ï† = Ï†')    â”‚
                    â”‚  â€¢ Replay Buffer (empty)              â”‚
                    â”‚  â€¢ OU Noise (Ïƒ = 0.7)                 â”‚
                    â”‚  â€¢ Curriculum (wide comfort zone)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  2ï¸âƒ£ FOR EACH EPISODE                  â”‚
                    â”‚  â€¢ Reset environment (7-day warmup)   â”‚
                    â”‚  â€¢ Update curriculum bands            â”‚
                    â”‚  â€¢ Reset OU noise                     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  3ï¸âƒ£ FOR EACH TIMESTEP                                 â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
          â”‚  â”‚ a) Select Action:                               â”‚  â”‚
          â”‚  â”‚    â€¢ a = Actor(s) + OU_noise                    â”‚  â”‚
          â”‚  â”‚    â€¢ Îµ-greedy: random if rand < Îµ               â”‚  â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
          â”‚                          â”‚                            â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
          â”‚  â”‚ b) Execute in FMU Environment:                  â”‚  â”‚
          â”‚  â”‚    â€¢ s', r, done = env.step(a)                  â”‚  â”‚
          â”‚  â”‚    â€¢ Store (s, a, r, s', done) â†’ Buffer         â”‚  â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
          â”‚                          â”‚                            â”‚
          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
          â”‚  â”‚ c) TRAIN (if buffer_size >= batch_size):        â”‚  â”‚
          â”‚  â”‚                                                 â”‚  â”‚
          â”‚  â”‚    CRITIC UPDATE:                               â”‚  â”‚
          â”‚  â”‚    y = r + Î³ Ã— min(Q1', Q2')(s', Actor'(s'))    â”‚  â”‚
          â”‚  â”‚    L_critic = Î£ w_i Ã— (Q(s,a) - y)Â²             â”‚  â”‚
          â”‚  â”‚    Update priorities: p_i = |TD_error| + Îµ      â”‚  â”‚
          â”‚  â”‚                                                 â”‚  â”‚
          â”‚  â”‚    ACTOR UPDATE:                                â”‚  â”‚
          â”‚  â”‚    L_actor = -Q1(s, Actor(s))                   â”‚  â”‚
          â”‚  â”‚                                                 â”‚  â”‚
          â”‚  â”‚    SOFT UPDATE TARGETS:                         â”‚  â”‚
          â”‚  â”‚    Î¸' â† Ï„Î¸ + (1-Ï„)Î¸'  |  Ï†' â† Ï„Ï† + (1-Ï„)Ï†'     â”‚  â”‚
          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  4ï¸âƒ£ END EPISODE                       â”‚
                    â”‚  â€¢ Update LR scheduler (if needed)    â”‚
                    â”‚  â€¢ Save checkpoint (every N eps)      â”‚
                    â”‚  â€¢ Save best model (if improved)      â”‚
                    â”‚  â€¢ Log metrics                        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Chi Tiáº¿t CÃ´ng Suáº¥t Thiáº¿t Bá»‹ HVAC

> *PhÃ¢n tÃ­ch hiá»‡u suáº¥t vÃ  cÃ´ng suáº¥t tá»«ng component trong há»‡ thá»‘ng*

### ğŸ“Š Báº£ng Tá»•ng Há»£p Thiáº¿t Bá»‹

| Thiáº¿t bá»‹ | CÃ´ng suáº¥t Ä‘á»‹nh má»©c | CÃ´ng thá»©c tÃ­nh cÃ´ng suáº¥t | Hiá»‡u suáº¥t/COP | Äáº·c Ä‘iá»ƒm |
|----------|-------------------|--------------------------|---------------|----------|
| **Supply Fan** | 70 W | $P = 70 \times (\dot{m}/0.24)^3$ | Fan affinity law | Biáº¿n táº§n, Ä‘iá»u khiá»ƒn lÆ°u lÆ°á»£ng |
| **Exhaust Fan** | 50 W | $P = 50 \times (\dot{m}/0.24)^3$ | Fan affinity law | Biáº¿n táº§n, cÃ¢n báº±ng Ã¡p suáº¥t |
| **Chiller** | 4000 W | $P = \|Q_{eva}\| / 1.5$ | COP = 1.5 | Carnot cycle, modulated TEva |
| **CW Pump** | 180 W | $P = 180 \times (\dot{m}/0.35)^3$ | Pump affinity law | dp setpoint = 8 kPa |
| **Heater** | 2000 W | $P = Q_{heater}$ | Î· = 100% | Electric resistance |

---

### ğŸŒ€ Supply Fan (fanSA) - Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸŒ€ SUPPLY FAN SPECIFICATIONS              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model:           FlowControlled_m_flow                     â”‚
â”‚  Nominal Power:   70 W (Pfan_nominal)                       â”‚
â”‚  Nominal Flow:    0.24 kg/s (mAir_flow_nominal)             â”‚
â”‚  Control:         Mass flow rate setpoint tá»« RL             â”‚
â”‚  dpMax:           50Ã—10â¹ Pa (safety limit cho simulation)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PRESSURE CURVE (characteristic):                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  V_flow (mÂ³/s)  â”‚  dp (Pa)               â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚      0          â”‚   600                  â”‚               â”‚
â”‚  â”‚   0.20 (nom)    â”‚   400                  â”‚               â”‚
â”‚  â”‚   0.40          â”‚     0                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POWER VS FLOW (Cubic Law):                                 â”‚
â”‚                                                             â”‚
â”‚  P_fan = P_nominal Ã— (á¹_actual / á¹_nominal)Â³               â”‚
â”‚                                                             â”‚
â”‚  Examples:                                                  â”‚
â”‚  â€¢ uFan = 0.3: á¹ = 0.072 kg/s â†’ P = 70Ã—(0.3)Â³ = 1.89 W    â”‚
â”‚  â€¢ uFan = 0.5: á¹ = 0.120 kg/s â†’ P = 70Ã—(0.5)Â³ = 8.75 W    â”‚
â”‚  â€¢ uFan = 0.8: á¹ = 0.192 kg/s â†’ P = 70Ã—(0.8)Â³ = 35.84 W   â”‚
â”‚  â€¢ uFan = 1.0: á¹ = 0.240 kg/s â†’ P = 70Ã—(1.0)Â³ = 70.00 W   â”‚
â”‚                                                             â”‚
â”‚  RL Control Range: uFan âˆˆ [0.1, 0.8]                       â”‚
â”‚  â†’ Power Range: [0.07 W, 35.84 W]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸŒ€ Exhaust Fan (fanEA) - Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸŒ€ EXHAUST FAN SPECIFICATIONS              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model:           FlowControlled_m_flow                     â”‚
â”‚  Nominal Power:   50 W (PfanEA_nominal)                     â”‚
â”‚  Nominal Flow:    0.24 kg/s                                 â”‚
â”‚  Control:         Mass flow rate setpoint tá»« RL             â”‚
â”‚  dpMax:           10Ã—10â¹ Pa (safety limit)                  â”‚
â”‚  Initial Flow:    0.3 Ã— nominal = 0.072 kg/s               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PRESSURE CURVE:                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  V_flow (mÂ³/s)  â”‚  dp (Pa)               â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚      0          â”‚   400                  â”‚               â”‚
â”‚  â”‚   0.20 (nom)    â”‚   300                  â”‚               â”‚
â”‚  â”‚   0.40          â”‚     0                  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RL CONTROL RANGE:                                          â”‚
â”‚  uFanEA âˆˆ [0.2, 0.7] â†’ mapped from network output [0, 1]   â”‚
â”‚                                                             â”‚
â”‚  Power Examples:                                            â”‚
â”‚  â€¢ uFanEA = 0.2: P = 50Ã—(0.2)Â³ = 0.4 W                     â”‚
â”‚  â€¢ uFanEA = 0.5: P = 50Ã—(0.5)Â³ = 6.25 W                    â”‚
â”‚  â€¢ uFanEA = 0.7: P = 50Ã—(0.7)Â³ = 17.15 W                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### â„ï¸ Chiller (Carnot_TEva_NoWarn) - Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â„ï¸ CHILLER SPECIFICATIONS                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model:           Carnot_TEva_NoWarn (Custom Model)         â”‚
â”‚  Type:            Water-cooled chiller vá»›i Carnot cycle     â”‚
â”‚  Cooling Capacity: 6000 W (QEva_flow_nominal)               â”‚
â”‚  COP Nominal:     1.5 (COP_chiller_nominal)                 â”‚
â”‚  Max Electrical:  4000 W (P_chiller_nominal)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EVAPORATOR TEMPERATURE CONTROL:                            â”‚
â”‚                                                             â”‚
â”‚  TEva_effective = u Ã— TEva_cold + (1-u) Ã— TEva_off         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  uChiller  â”‚  TEva_eff     â”‚  Mode       â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚    0.0     â”‚  298.15 K (25Â°C) â”‚  OFF      â”‚               â”‚
â”‚  â”‚    0.25    â”‚  292.90 K (20Â°C) â”‚  Low      â”‚               â”‚
â”‚  â”‚    0.50    â”‚  287.65 K (14Â°C) â”‚  Medium   â”‚               â”‚
â”‚  â”‚    0.75    â”‚  282.40 K (9Â°C)  â”‚  High     â”‚               â”‚
â”‚  â”‚    1.00    â”‚  277.15 K (4Â°C)  â”‚  Full     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POWER & ENERGY CALCULATION:                                â”‚
â”‚                                                             â”‚
â”‚  P_chiller = |Q_evaporator| / COP = |Q_eva| / 1.5          â”‚
â”‚                                                             â”‚
â”‚  Power Examples (assuming proportional cooling):            â”‚
â”‚  â€¢ Q_eva = -1500 W â†’ P = 1000 W                            â”‚
â”‚  â€¢ Q_eva = -3000 W â†’ P = 2000 W                            â”‚
â”‚  â€¢ Q_eva = -4500 W â†’ P = 3000 W                            â”‚
â”‚  â€¢ Q_eva = -6000 W â†’ P = 4000 W (max)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ENERGY BALANCE (Thermodynamics):                           â”‚
â”‚                                                             â”‚
â”‚  Q_condenser = Q_evaporator + P_electric                   â”‚
â”‚  Q_con = -(1 + 1/COP) Ã— Q_eva                              â”‚
â”‚                                                             â”‚
â”‚  At full capacity:                                          â”‚
â”‚  Q_con = -6000 Ã— (1 + 1/1.5) = -10000 W (heat rejected)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”„ Chilled Water Pump (pumpCW) - Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ”„ CW PUMP SPECIFICATIONS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model:           FlowControlled_dp                         â”‚
â”‚  Nominal Power:   180 W (PpumpCW_nominal)                   â”‚
â”‚  Nominal Flow:    0.35 kg/s (mWat_flow_nominal)             â”‚
â”‚  Control:         Differential pressure setpoint            â”‚
â”‚  dp Setpoint:     8000 Pa (8 kPa) - constant                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PUMP CHARACTERISTIC:                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  V_flow (mÂ³/s)    â”‚  dp available (Pa)   â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚      0            â”‚   10000              â”‚               â”‚
â”‚  â”‚   0.35Ã—10â»Â³       â”‚       0              â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POWER CALCULATION (Cubic Law):                             â”‚
â”‚                                                             â”‚
â”‚  P_pump = P_nominal Ã— (á¹_actual / á¹_nominal)Â³              â”‚
â”‚         = 180 Ã— (á¹ / 0.35)Â³                                â”‚
â”‚                                                             â”‚
â”‚  Power varies with chiller load (water flow demand)         â”‚
â”‚  â€¢ Low chiller: Low flow â†’ Very low pump power             â”‚
â”‚  â€¢ High chiller: High flow â†’ Higher pump power             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”¥ Heater Coil (heaCoil) - Chi Tiáº¿t

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ”¥ HEATER SPECIFICATIONS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model:           HeaterCooler_u                            â”‚
â”‚  Nominal Power:   2000 W (Q_heater_nominal)                 â”‚
â”‚  Type:            Electric resistance heater                â”‚
â”‚  Efficiency:      100% (electric â†’ heat conversion)         â”‚
â”‚  Pressure Drop:   50 Pa (dp_nominal)                        â”‚
â”‚  Time Constant:   90 s (tau - thermal inertia)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CONTROL CONSTRAINT (Safety):                               â”‚
â”‚                                                             â”‚
â”‚  uHeater_actual = min(0.7 + 0.3Ã—uOA, uHeater_requested)    â”‚
â”‚                                                             â”‚
â”‚  Rationale:                                                 â”‚
â”‚  â€¢ Khi uOA tháº¥p (Ã­t giÃ³ tÆ°Æ¡i): heater bá»‹ giá»›i háº¡n          â”‚
â”‚    â†’ TrÃ¡nh quÃ¡ nhiá»‡t do thiáº¿u lÆ°u lÆ°á»£ng                    â”‚
â”‚  â€¢ Khi uOA cao (nhiá»u giÃ³ tÆ°Æ¡i): heater cÃ³ thá»ƒ cháº¡y full   â”‚
â”‚    â†’ Äá»§ lÆ°u lÆ°á»£ng Ä‘á»ƒ táº£n nhiá»‡t                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POWER OUTPUT CALCULATION:                                  â”‚
â”‚                                                             â”‚
â”‚  Q_heater = u Ã— Q_nominal Ã— flow_fraction                  â”‚
â”‚  P_heater = Q_heater (vÃ¬ Î· = 100%)                         â”‚
â”‚                                                             â”‚
â”‚  flow_fraction = min(1, á¹_SA / (0.15 Ã— á¹_nominal))         â”‚
â”‚                                                             â”‚
â”‚  Examples:                                                  â”‚
â”‚  â€¢ uHeater = 0.3, full flow: Q = 0.3Ã—2000Ã—1 = 600 W        â”‚
â”‚  â€¢ uHeater = 0.6, full flow: Q = 0.6Ã—2000Ã—1 = 1200 W       â”‚
â”‚  â€¢ uHeater = 1.0, half flow: Q = 1.0Ã—2000Ã—0.5 = 1000 W     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Š So SÃ¡nh CÃ´ng Suáº¥t TiÃªu Thá»¥

#### ğŸ”‹ Power Consumption Breakdown (Operating Modes)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              âš¡ TYPICAL POWER CONSUMPTION BY MODE                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  ğŸŒ¡ï¸ COOLING MODE (MÃ¹a hÃ¨, uChiller = 0.8):                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Chiller:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  3200 W (94%)â”‚   â”‚
â”‚  â”‚  Pump:     â–ˆâ–ˆâ–ˆ                                    144 W (4%) â”‚   â”‚
â”‚  â”‚  Fan SA:   â–ˆ                                       36 W (1%) â”‚   â”‚
â”‚  â”‚  Fan EA:   â–ˆ                                       17 W (0.5%)â”‚   â”‚
â”‚  â”‚  Heater:   â–‘                                        0 W (0%) â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚  TOTAL:                                          3397 W      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ğŸ”¥ HEATING MODE (MÃ¹a Ä‘Ã´ng, uHeater = 0.6):                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Heater:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    1200 W (92%)â”‚   â”‚
â”‚  â”‚  Fan SA:   â–ˆâ–ˆ                                      36 W (3%) â”‚   â”‚
â”‚  â”‚  Fan EA:   â–ˆ                                       17 W (1%) â”‚   â”‚
â”‚  â”‚  Pump:     â–ˆ                                       50 W (4%) â”‚   â”‚
â”‚  â”‚  Chiller:  â–‘                                        0 W (0%) â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚  TOTAL:                                          1303 W      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  ğŸŒ¿ MILD/VENTILATION MODE (ThÃ´ng giÃ³, no active conditioning):     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Fan SA:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       50 W (58%)â”‚   â”‚
â”‚  â”‚  Fan EA:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              35 W (40%)â”‚   â”‚
â”‚  â”‚  Pump:     â–‘                                        2 W (2%) â”‚   â”‚
â”‚  â”‚  Chiller:  â–‘                                        0 W (0%) â”‚   â”‚
â”‚  â”‚  Heater:   â–‘                                        0 W (0%) â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚
â”‚  â”‚  TOTAL:                                            87 W      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ“ˆ Efficiency & Energy Optimization Insights

| Priority | Thiáº¿t bá»‹ | Impact | Optimization Strategy |
|----------|----------|--------|----------------------|
| **#1** | Chiller | 80-95% power (cooling) | NÃ¢ng TEva setpoint khi cÃ³ thá»ƒ; Free cooling vá»›i uOA cao khi T_out < T_zone |
| **#2** | Heater | 90%+ power (heating) | Giáº£m setpoint khi khÃ´ng cÃ³ ngÆ°á»i; Heat recovery tá»« exhaust |
| **#3** | Fans | Cubic law benefit | Giáº£m flow khi low occupancy; VAV strategy hiá»‡u quáº£ |
| **#4** | Pump | Following chiller | VSD control; Giáº£m flow khi chiller load tháº¥p |

---

### ğŸ¯ Energy Reference for Reward Calculation

```python
# Reference power for reward normalization
P_ref = 2500 W  # 2.5 kW reference

# Energy cost in reward function:
E_norm = min(P_total_kW / P_ref_kW, 2.0)
energy_cost = weight_energy Ã— (E_norm)Â²

# Interpretation:
# P_total = 2500 W â†’ E_norm = 1.0 â†’ energy_cost = weight Ã— 1.0
# P_total = 5000 W â†’ E_norm = 2.0 â†’ energy_cost = weight Ã— 4.0 (capped)
# P_total = 1250 W â†’ E_norm = 0.5 â†’ energy_cost = weight Ã— 0.25
```

---

## âœ¨ TÃ­nh NÄƒng Ná»•i Báº­t

| TÃ­nh nÄƒng | MÃ´ táº£ |
|-----------|-------|
| ğŸ§  **Twin Q-Networks** | Sá»­ dá»¥ng hai máº¡ng Critic Ä‘á»ƒ giáº£m overestimation bias |
| ğŸ“Š **Prioritized Experience Replay** | Há»c hiá»‡u quáº£ hÆ¡n tá»« cÃ¡c tráº£i nghiá»‡m quan trá»ng |
| ğŸ“š **Curriculum Learning** | Huáº¥n luyá»‡n tiáº¿n dáº§n tá»« dá»… Ä‘áº¿n khÃ³ |
| ğŸ”„ **Adaptive Learning Rate** | Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh tá»‘c Ä‘á»™ há»c |
| ğŸŒ¤ï¸ **Dual Mode** | Há»— trá»£ cáº£ cÃ³ vÃ  khÃ´ng cÃ³ dá»± bÃ¡o thá»i tiáº¿t |
| ğŸšï¸ **Hierarchical Reward** | Pháº§n thÆ°á»Ÿng phÃ¢n cáº¥p cho comfort vÃ  energy |

---

## ğŸ“ Cáº¥u TrÃºc Project

```
HVAC-DDPG-Control/
â”‚
â”œâ”€â”€ ğŸ“„ HVAC.fmu              # FMU mÃ´ phá»ng há»‡ thá»‘ng HVAC
â”œâ”€â”€ ğŸ“„ HVAC.mo               # Modelica source code cá»§a FMU
â”œâ”€â”€ ğŸ“„ requirements.txt      # Dependencies cá»§a project
â”œâ”€â”€ ğŸ“„ setup.py              # Package setup file
â”‚
â”œâ”€â”€ ğŸ“‚ configs/              # âš™ï¸ Cáº¥u hÃ¬nh há»‡ thá»‘ng
â”œâ”€â”€ ğŸ“‚ data/                 # ğŸ“Š Dá»¯ liá»‡u thá»i tiáº¿t
â”œâ”€â”€ ğŸ“‚ src/                  # ğŸ’» Source code chÃ­nh
â”œâ”€â”€ ğŸ“‚ scripts/              # ğŸ”§ Scripts huáº¥n luyá»‡n & Ä‘Ã¡nh giÃ¡
â”œâ”€â”€ ğŸ“‚ notebooks/            # ğŸ““ Jupyter notebooks
â”œâ”€â”€ ğŸ“‚ checkpoints/          # ğŸ’¾ Model checkpoints
â””â”€â”€ ğŸ“‚ results/              # ğŸ“ˆ Káº¿t quáº£ training & evaluation
```

---

## ğŸ“‚ Chi Tiáº¿t Tá»«ng ThÆ° Má»¥c

### ğŸ”§ `configs/` - Cáº¥u HÃ¬nh Há»‡ Thá»‘ng

> *Trung tÃ¢m Ä‘iá»u khiá»ƒn táº¥t cáº£ hyperparameters vÃ  settings*

```
configs/
â”œâ”€â”€ __init__.py          # Package initialization
â”œâ”€â”€ base_config.py       # ğŸ›ï¸ Class BaseConfig chá»©a táº¥t cáº£ config
â””â”€â”€ config_manager.py    # ğŸ”§ Helper functions cho config
```

| File | Vai trÃ² |
|------|---------|
| **`base_config.py`** | Äá»‹nh nghÄ©a class `BaseConfig` chá»©a toÃ n bá»™ hyperparameters: learning rate, network architecture, reward weights, comfort bands, v.v. Há»— trá»£ tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i giá»¯a cháº¿ Ä‘á»™ forecast (state_dim=15) vÃ  no-forecast (state_dim=14) |
| **`config_manager.py`** | Cung cáº¥p `get_train_config()` vÃ  `get_eval_config()` Ä‘á»ƒ khá»Ÿi táº¡o config vá»›i Ä‘Æ°á»ng dáº«n file phÃ¹ há»£p |

---

### ğŸ“Š `data/` - Dá»¯ Liá»‡u Thá»i Tiáº¿t

> *Dá»¯ liá»‡u khÃ­ háº­u thá»±c tá»« cÃ¡c thÃ nh phá»‘ Viá»‡t Nam*

```
data/
â”œâ”€â”€ Ha_Dong_FULL_YEAR.csv                              # ğŸ™ï¸ HÃ  Ná»™i - cáº£ nÄƒm
â”œâ”€â”€ Da_Nang_FULL_YEAR.csv                              # ğŸ–ï¸ ÄÃ  Náºµng - cáº£ nÄƒm  
â”œâ”€â”€ Nha_Be_FULL_YEAR.csv                               # ğŸŒ´ TP.HCM - cáº£ nÄƒm
â”œâ”€â”€ sample_data_training_weather_data_Ha_Dong_cold_M01_M02.csv  # â„ï¸ Training mÃ¹a láº¡nh
â”œâ”€â”€ sample_data_testing_weather_data_Ha_Dong_M03_M04.csv        # ğŸ§ª Testing data
â”œâ”€â”€ best_forecast_M07_M08.csv                          # ğŸ”® Dá»¯ liá»‡u cÃ³ forecast
â””â”€â”€ training_forecast_model.py                         # ğŸ¤– Script train forecast model
```

**CÃ¡c cá»™t dá»¯ liá»‡u chÃ­nh:**
- `time` - Timestamp (seconds)
- `TDryBul` - Nhiá»‡t Ä‘á»™ khÃ´ (Â°C)
- `relHum` - Äá»™ áº©m tÆ°Æ¡ng Ä‘á»‘i (%)
- `pAtm` - Ãp suáº¥t khÃ­ quyá»ƒn (Pa)
- `winSpe` - Tá»‘c Ä‘á»™ giÃ³ (m/s)
- `HDirNor` - Bá»©c xáº¡ trá»±c tiáº¿p (W/mÂ²)
- `HDifHor` - Bá»©c xáº¡ khuáº¿ch tÃ¡n (W/mÂ²)
- `T_forecast` - Dá»± bÃ¡o nhiá»‡t Ä‘á»™ (optional)

---

### ğŸ’» `src/` - Source Code ChÃ­nh

> *TrÃ¡i tim cá»§a há»‡ thá»‘ng - nÆ¡i chá»©a toÃ n bá»™ logic AI*

```
src/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ ğŸ“‚ agents/           # ğŸ¤– DDPG Agent
â”œâ”€â”€ ğŸ“‚ environments/     # ğŸŒ HVAC Environment
â”œâ”€â”€ ğŸ“‚ models/           # ğŸ§  Neural Networks
â”œâ”€â”€ ğŸ“‚ utils/            # ğŸ› ï¸ Utility functions
â””â”€â”€ ğŸ“‚ visualization/    # ğŸ“Š Plotting functions
```

---

#### ğŸ¤– `src/agents/` - DDPG Agent

```
agents/
â”œâ”€â”€ __init__.py
â””â”€â”€ ddpg_agent.py        # ğŸ® Class DDPGAgent
```

**`ddpg_agent.py`** - *Agent thÃ´ng minh Ä‘iá»u khiá»ƒn HVAC*

| Component | MÃ´ táº£ |
|-----------|-------|
| `DDPGAgent` | Class chÃ­nh quáº£n lÃ½ toÃ n bá»™ quÃ¡ trÃ¬nh há»c |
| `select_action()` | Chá»n action vá»›i exploration noise |
| `update()` | Cáº­p nháº­t weights tá»« replay buffer |
| `soft_update()` | Cáº­p nháº­t má»m target networks |
| `save()/load()` | LÆ°u/load model checkpoint |

**Äáº·c Ä‘iá»ƒm ná»•i báº­t:**
- âœ… Twin Q-Networks (2 Critics) Ä‘á»ƒ giáº£m overestimation
- âœ… Prioritized Experience Replay
- âœ… Adaptive OU Noise cho exploration
- âœ… Adaptive Learning Rate Scheduler

---

#### ğŸŒ `src/environments/` - HVAC Environment

```
environments/
â”œâ”€â”€ __init__.py
â””â”€â”€ hvac_env.py          # ğŸ¢ Class HVACEnvironment
```

**`hvac_env.py`** - *MÃ´i trÆ°á»ng mÃ´ phá»ng há»‡ thá»‘ng HVAC*

| Method | MÃ´ táº£ |
|--------|-------|
| `reset()` | Khá»Ÿi táº¡o láº¡i FMU vÃ  tráº£ vá» state Ä‘áº§u tiÃªn |
| `step(action)` | Thá»±c hiá»‡n action, tráº£ vá» (state, reward, done, info) |
| `_build_state()` | XÃ¢y dá»±ng vector state 14D hoáº·c 15D |
| `_get_weather_at()` | Ná»™i suy dá»¯ liá»‡u thá»i tiáº¿t |

**State Vector (14D hoáº·c 15D):**
```
[T_zone, RH_zone, T_out, RH_out, T_AHU_out, RH_AHU_out, 
 delta_T, delta_RH, hour_sin, hour_cos, occupancy,
 prev_uFan, prev_uChiller, prev_uHeater, (T_forecast)]
```

**Action Vector (5D):**
```
[uFan, uOA, uChiller, uHeater, uFanEA] âˆˆ [0, 1]
```

---

#### ğŸ§  `src/models/` - Neural Networks

```
models/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ actor.py             # ğŸ­ Actor Network
â””â”€â”€ critic.py            # ğŸ“Š Critic Network (Twin Q)
```

**`actor.py`** - *Máº¡ng quyáº¿t Ä‘á»‹nh hÃ nh Ä‘á»™ng*

```
State â†’ [FC 512] â†’ LayerNorm â†’ ReLU 
      â†’ [FC 512] â†’ LayerNorm â†’ ReLU 
      â†’ [FC 5] â†’ Tanh â†’ Action
```

**`critic.py`** - *Máº¡ng Ä‘Ã¡nh giÃ¡ Q-value (Twin)*

```
State + Action â†’ [FC 512] â†’ ReLU â†’ [FC 512] â†’ ReLU â†’ Q1
State + Action â†’ [FC 512] â†’ ReLU â†’ [FC 512] â†’ ReLU â†’ Q2
```

---

#### ğŸ› ï¸ `src/utils/` - Utilities

```
utils/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ noise.py             # ğŸ² Adaptive OU Noise
â”œâ”€â”€ replay_buffer.py     # ğŸ’¾ Prioritized Replay Buffer
â”œâ”€â”€ reward.py            # ğŸ¯ Hierarchical Reward Calculator
â””â”€â”€ scheduler.py         # ğŸ“ˆ Adaptive LR Scheduler
```

| File | Class/Function | Vai trÃ² |
|------|----------------|---------|
| **`noise.py`** | `AdaptiveOUNoise` | Ornstein-Uhlenbeck noise vá»›i decay tá»± Ä‘á»™ng |
| **`replay_buffer.py`** | `PrioritizedReplayBuffer` | Buffer vá»›i importance sampling |
| **`reward.py`** | `HierarchicalRewardCalculator` | TÃ­nh reward dá»±a trÃªn comfort + energy |
| **`scheduler.py`** | `AdaptiveLRScheduler` | Giáº£m LR khi reward khÃ´ng cáº£i thiá»‡n |

**Reward Formula:**
```python
reward = - (w_temp * temp_penalty + w_humidity * humidity_penalty + w_energy * energy_penalty)
```

**Curriculum Learning:**
- Episode 1-10: Comfort band rá»™ng (dá»…)
- Episode 10-30: Thu háº¹p dáº§n comfort band
- Episode 30+: Comfort band cháº·t nháº¥t

---

#### ğŸ“Š `src/visualization/` - Plotting

```
visualization/
â”œâ”€â”€ __init__.py
â””â”€â”€ plotting.py          # ğŸ“ˆ Visualization functions
```

| Function | MÃ´ táº£ |
|----------|-------|
| `plot_training_progress()` | Váº½ Ä‘Æ°á»ng cong reward theo episode |
| `plot_evaluation_results()` | Dashboard Ä‘Ã¡nh giÃ¡ vá»›i nhiá»‡t Ä‘á»™, Ä‘á»™ áº©m, nÄƒng lÆ°á»£ng |
| `print_comfort_statistics()` | In thá»‘ng kÃª comfort zone vÃ  violations |

---

### ğŸ”§ `scripts/` - Scripts Cháº¡y

```
scripts/
â”œâ”€â”€ train.py             # ğŸ‹ï¸ Script huáº¥n luyá»‡n
â””â”€â”€ evaluate.py          # ğŸ§ª Script Ä‘Ã¡nh giÃ¡
```

**`train.py`** - *Huáº¥n luyá»‡n agent*
```bash
python scripts/train.py --weather data/Ha_Dong_FULL_YEAR.csv --episodes 50
```

**`evaluate.py`** - *ÄÃ¡nh giÃ¡ model Ä‘Ã£ train*
```bash
python scripts/evaluate.py --model checkpoints/best_model.pth --weather data/test.csv
```

---

### ğŸ““ `notebooks/` - Jupyter Notebooks

> *Notebooks tÆ°Æ¡ng tÃ¡c cho research vÃ  demo*

```
notebooks/
â”œâ”€â”€ Train_DDPG.ipynb            # ğŸ‹ï¸ Training notebook (no forecast)
â”œâ”€â”€ Train_DDPG_FC.ipynb         # ğŸ‹ï¸ Training notebook (with forecast)
â”œâ”€â”€ Test_DDPG.ipynb             # ğŸ§ª Testing notebook (no forecast)
â”œâ”€â”€ Test_DDPG_FC.ipynb          # ğŸ§ª Testing notebook (with forecast)
â”œâ”€â”€ DDPG.ipynb                  # ğŸ“š DDPG algorithm explanation
â””â”€â”€ Build_Data_for_Sim.ipynb    # ğŸ”§ Data preprocessing
```

| Notebook | Má»¥c Ä‘Ã­ch |
|----------|----------|
| **Train_DDPG.ipynb** | Huáº¥n luyá»‡n model mode no-forecast |
| **Train_DDPG_FC.ipynb** | Huáº¥n luyá»‡n model mode forecast |
| **Test_DDPG.ipynb** | ÄÃ¡nh giÃ¡ model no-forecast |
| **Test_DDPG_FC.ipynb** | ÄÃ¡nh giÃ¡ model forecast |
| **Build_Data_for_Sim.ipynb** | Chuáº©n bá»‹ vÃ  xá»­ lÃ½ dá»¯ liá»‡u thá»i tiáº¿t |

---

### ğŸ’¾ `checkpoints/` - Model Checkpoints

```
checkpoints/
â”œâ”€â”€ no_forecast/         # ğŸ“ Models trained without forecast
â”‚   â””â”€â”€ best_model.pth
â””â”€â”€ with_forecast/       # ğŸ“ Models trained with forecast
    â””â”€â”€ best_model.pth
```

**Checkpoint structure:**
```python
{
    'actor_state_dict': ...,
    'critic_state_dict': ...,
    'actor_optimizer': ...,
    'critic_optimizer': ...,
    'episode': ...,
    'best_reward': ...
}
```

---

### ğŸ“ˆ `results/` - Káº¿t Quáº£

```
results/
â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ no_forecast/
â”‚   â”‚   â””â”€â”€ training_curves.png
â”‚   â””â”€â”€ forecast/
â”‚       â””â”€â”€ training_curves.png
â””â”€â”€ evaluation/
    â”œâ”€â”€ no_forecast/
    â”‚   â””â”€â”€ eval_run_data.csv
    â””â”€â”€ forecast/
        â””â”€â”€ eval_run_data.csv
```

**Evaluation metrics trong CSV:**
- Temperature trong comfort zone (%)
- Humidity trong comfort zone (%)
- Total energy consumption (kWh)
- Average reward

---

## ğŸ”§ CÃ i Äáº·t

### Prerequisites

- Python 3.8+
- CUDA (optional, for GPU training)

### Installation

```bash
# Clone repository
git clone https://github.com/your-repo/HVAC-DDPG-Control.git
cd HVAC-DDPG-Control

# Create virtual environment
python -m venv venv
source venv/bin/activate  # Linux/Mac
# hoáº·c
.\venv\Scripts\activate  # Windows

# Install dependencies
pip install -r requirements.txt
```

### Key Dependencies

| Package | Version | Purpose |
|---------|---------|---------|
| `torch` | â‰¥2.0 | Deep Learning framework |
| `numpy` | â‰¥1.26 | Numerical computing |
| `pandas` | â‰¥2.0 | Data processing |
| `matplotlib` | â‰¥3.10 | Visualization |
| `pyfmi` | â‰¥2.9 | FMU simulation |

---

## ğŸš€ HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### 1ï¸âƒ£ Training

```python
from configs.config_manager import get_train_config
from src.agents import DDPGAgent
from src.environments import HVACEnvironment

# Load config
config = get_train_config(
    fmu_path='HVAC.fmu',
    weather_csv='data/Ha_Dong_FULL_YEAR.csv',
    use_forecast=False
)

# Initialize
env = HVACEnvironment(config)
agent = DDPGAgent(config)

# Training loop
for episode in range(config.NUM_EPISODES):
    state = env.reset()
    total_reward = 0
    
    while True:
        action = agent.select_action(state)
        next_state, reward, done, _ = env.step(action)
        agent.replay_buffer.push(state, action, reward, next_state, done)
        agent.update()
        
        state = next_state
        total_reward += reward
        
        if done:
            break
    
    print(f"Episode {episode}: Reward = {total_reward:.2f}")
```

### 2ï¸âƒ£ Evaluation

```python
from configs.config_manager import get_eval_config
from src.agents import DDPGAgent
from src.environments import HVACEnvironment
from src.visualization import plot_evaluation_results, print_comfort_statistics

# Load trained model
config = get_eval_config(...)
agent = DDPGAgent(config)
agent.load('checkpoints/no_forecast/best_model.pth')

# Run evaluation
env = HVACEnvironment(config)
state = env.reset()
results = []

while True:
    action = agent.select_action(state, add_noise=False)
    next_state, reward, done, info = env.step(action)
    results.append(info)
    state = next_state
    if done:
        break

# Visualize
plot_evaluation_results(results)
print_comfort_statistics(results)
```

---

## ğŸ“Š Káº¿t Quáº£

### Training Curves

| Metric | No Forecast | With Forecast |
|--------|-------------|---------------|
| Final Reward | -XXX | -XXX |
| Convergence | ~30 episodes | ~25 episodes |
| Temperature Comfort | 95%+ | 97%+ |

### Comfort Zone Performance

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          ğŸ“Š COMFORT ZONE STATISTICS                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ğŸŒ¡ï¸ Temperature (26-27.5Â°C):  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  95.2%  â•‘
â•‘  ğŸ’§ Humidity (45-65%):        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 92.8%  â•‘
â•‘  âš¡ Energy saved:             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  35.2%  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ—ºï¸ Roadmap

- [x] Basic DDPG implementation
- [x] Twin Q-Networks
- [x] Prioritized Experience Replay
- [x] Curriculum Learning
- [x] Weather forecast integration
- [ ] Multi-zone support
- [ ] Real-time deployment
- [ ] Web dashboard

---

## ğŸ“œ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ‘¥ Contributors

<div align="center">

**Capstone Project - FA25**

*FPT University*

</div>

---

<div align="center">

**â­ Star this repo if you find it useful!**

Made with â¤ï¸ and ğŸ¤– AI

</div>
